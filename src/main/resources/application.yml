# ============================================
# üé≠ Seat Saga Platform - BASE CONFIG
# ============================================
# Default configuration when NO profile is active.
# Contains ONLY common settings shared across ALL environments.
# ============================================
spring:
  # ============================================
  # ‚öôÔ∏è SPRING SECURITY & OAUTH2
  # ============================================
  security:
    oauth2:
      client:
        registration:
          google:
            client-id: ${GOOGLE_CLIENT_ID}
            client-secret: ${GOOGLE_CLIENT_SECRET}
            scope: email,profile

#  config:
#    activate:
#      on-profile: "default"   # Runs when no specific profile is set
  # ============================================
  # üóÑÔ∏è DATABASE CONFIGURATION (Common)
  # ============================================
  datasource:
    url: ${SPRING_DATASOURCE_URL}               # MUST be set via environment variables
    username: ${SPRING_DATASOURCE_USERNAME}     # Never hardcode credentials
    password: ${SPRING_DATASOURCE_PASSWORD}     # Use Key Vault/Secrets in prod
    driver-class-name: org.postgresql.Driver    # Fixed for PostgreSQL

    hikari:
      maximum-pool-size: 10                     # Max connections
      minimum-idle: 2                           # Min idle connections
      connection-timeout: 30000                 # 30s timeout
      idle-timeout: 600000                      # 10m idle timeout
      max-lifetime: 1800000                     # 30m max connection lifetime

  # ============================================
  # ‚öôÔ∏è JPA / HIBERNATE CONFIGURATION
  # ============================================
  jpa:
    hibernate:
      ddl-auto: validate                        # Validate schema, never auto-create/update
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    open-in-view: false                         # Prevents LazyInitializationException

  # ============================================
  # üîÑ LIQUIBASE CONFIGURATION
  # ============================================
  liquibase:
    change-log: classpath:db/changelog/db.changelog-master.yaml  # Entry point
    enabled: true                               # Master switch

    default-schema: ${SPRING_LIQUIBASE_DEFAULT_SCHEMA:public}    # Schema for objects
    liquibase-schema: ${SPRING_LIQUIBASE_SCHEMA:public}          # Schema for Liquibase tables

    # Internal tracking tables (optional overrides)
    # database-change-log-table: DATABASECHANGELOG
    # database-change-log-lock-table: DATABASECHANGELOGLOCK

    # Safety settings
    drop-first: false                           # NEVER true in production
    clear-checksums: false                      # Only for dev debugging

    # Logging
    show-summary: summary                       # Options: OFF, SUMMARY, VERBOSE


# ============================================
# üåê APPLICATION SETTINGS
# ============================================
server:
  port: 8080                                   # Default port
  shutdown: graceful                           # Wait for requests to finish


# ============================================
# üìä LOGGING SETTINGS
# ============================================
logging:
  level:
    root: INFO                                 # Production-safe default
    liquibase: INFO


# ============================================
# üìà MANAGEMENT & METRICS
# ============================================
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus # Expose key actuator endpoints
  prometheus:
    metrics:
      export:
        enabled: true                          # Enable Prometheus metrics export



# ============================================
# üìñ API DOCUMENTATION (Springdoc / Swagger)
# ============================================
springdoc:
  api-docs:
    path: /api-docs                            # OpenAPI JSON spec endpoint
  swagger-ui:
    path: /swagger-ui.html                     # Swagger UI endpoint
    operations-sorter: method                  # Sort operations by HTTP method
