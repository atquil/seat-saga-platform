# ============================================
# üéØ MASTER CHANGELOG
# ============================================
# Purpose: Root entry point for all database migrations
# Location: src/main/resources/db/changelog/
# ============================================
# ‚ùó CRITICAL: This file orchestrates ALL database changes
# ‚ùó NEVER modify deployed changesets (creates checksum errors)
# ============================================

# ============================================
# ‚ö†Ô∏è IMPORTANT NOTES
# ============================================

# üö® EXECUTION ORDER
# 1. Files are included in the order listed
# 2. Within directories, files are processed alphabetically
# 3. Use numeric prefixes for ordering: 01-, 02-, etc.

# üîí CONTEXT STRATEGY
# Spring Boot sets: spring.liquibase.contexts=local
# Result: Only changesets with context='local' OR no context will run

# üìä AUDIT TRAIL
# All executed changesets are recorded in:
# 1. DATABASECHANGELOG table (what ran)
# 2. DATABASECHANGELOGLOCK table (prevents concurrent runs)

databaseChangeLog:
  # ============================================
  # üìÅ SCHEMA CHANGES (Version 1.0)
  # ============================================
  # Purpose: Include all structural changes for version 1.0
  # Path: Relative to classpath root
  # Best Practice: Organize by release version
  - includeAll:
      path: db/changelog/changes/v1.0/
      # üß≠ PATH RESOLUTION STRATEGY
      # relativeToChangelogFile: false ‚Üí Relative to classpath root
      # relativeToChangelogFile: true ‚Üí Relative to THIS file's location
      # ‚ùó Recommendation: Use false for consistency
      # ‚ùó Alternative: Use include with specific file names
      relativeToChangelogFile: false

  # ============================================
  # üìä LOCAL DEVELOPMENT DATA
  # ============================================
  - includeAll:
      path: db/changelog/data/local/
      relativeToChangelogFile: false
      context: local

  - includeAll:
      path: db/changelog/data/prod/
      relativeToChangelogFile: false
      context: prod